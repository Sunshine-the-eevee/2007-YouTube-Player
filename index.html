<script>
  // Progress Bar Updates (timeupdate event)
  video.addEventListener('timeupdate', function () {
    const currentTime = video.currentTime;
    const duration = video.duration;

    if (duration) {
      const progress = (currentTime / duration) * 100;
      document.getElementById('progressRed').style.width = `${progress}%`;

      // Update time display
      const minutes = Math.floor(currentTime / 60);
      const seconds = Math.floor(currentTime % 60);
      document.getElementById('timeCurrent').textContent = `${minutes}:${seconds < 10 ? '0' + seconds : seconds}`;
      document.getElementById('timeTotal').textContent = `${Math.floor(duration / 60)}:${Math.floor(duration % 60)}`;
    }
  });

  // Scrubber (Progress Handle) Dragging
  const progressHandle = document.getElementById('progressHandle');
  const progressBar = document.querySelector('.progress-section');

  let isDragging = false;
  progressHandle.addEventListener('mousedown', function (e) {
    isDragging = true;
    document.body.style.cursor = 'pointer';
  });

  document.addEventListener('mouseup', function () {
    if (isDragging) {
      isDragging = false;
      document.body.style.cursor = 'default';
    }
  });

  progressBar.addEventListener('mousemove', function (e) {
    if (isDragging) {
      const progressBarRect = progressBar.getBoundingClientRect();
      const offsetX = e.clientX - progressBarRect.left;
      const progress = Math.min(Math.max(0, offsetX), progressBarRect.width);
      const percentage = (progress / progressBarRect.width) * 100;

      // Move the scrubber handle visually
      progressHandle.style.left = `${percentage - 5}%`; // Adjust for the center position of the handle
      document.getElementById('progressRed').style.width = `${percentage}%`;

      // Update video current time
      video.currentTime = (percentage / 100) * video.duration;
    }
  });

  // Progress Bar Click (Direct Seek)
  progressBar.addEventListener('click', function (e) {
    const progressBarRect = progressBar.getBoundingClientRect();
    const offsetX = e.clientX - progressBarRect.left;
    const progress = Math.min(Math.max(0, offsetX), progressBarRect.width);
    const percentage = (progress / progressBarRect.width) * 100;

    // Update video current time based on where clicked
    video.currentTime = (percentage / 100) * video.duration;
  });

  // Ensuring smooth seeking behavior: Listen to the 'seeking' and 'seeked' events
  video.addEventListener('seeking', function () {
    console.log('Seeking to:', video.currentTime);
  });

  video.addEventListener('seeked', function () {
    console.log('Seeked to:', video.currentTime);
    video.play(); // Ensure the video starts playing after seeking
  });

</script>
